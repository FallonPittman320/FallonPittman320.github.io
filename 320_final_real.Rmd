---
title: 'Final Project: Data Analysis Tutorial'
author: "Bailey Fallon, William Pittman"
date: "5/20/2019"
output:
  html_document: default
  pdf_document: default
---
#United States College Analysis
#Data curation
##Data Description

We collected data from the [US Department of Education](https://collegescorecard.ed.gov/data/). Every year they release a data set on post secondary school like colleges and universities. This data set is considered to be every colleges scorecard. The college scorecard data set is designed to increase transparency between schools and the public. The data set is open to everyone from those looking to improve colleges to those looking to attend one.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

#Parsing
To begin we read the csvs in using read.csv. We decided to examine the data set from 2010 through the present, 8 years total. This was chosen because critical data points such the average salary for each undergraduate who received a degree started in 2010. Looking at past data sets would be useless as they contain to many null values. Aditional information can be found [here](http://www.hcbravo.org/IntroDataSci/bookdown-notes/ingesting-data.html).


```{r from csv, message=FALSE, warning=FALSE, include=TRUE}
library(broom)
library(tidyverse)
rm(list=ls())
school_2010 <- read.csv(file = 'MERGED2009_10_PP.csv')

school_2011 <- read.csv(file = 'MERGED2010_11_PP.csv')

school_2012 <- read.csv(file = 'MERGED2011_12_PP.csv')

school_2013 <- read.csv(file = 'MERGED2012_13_PP.csv')

school_2014 <- read.csv(file = 'MERGED2013_14_PP.csv')

school_2015 <- read.csv(file = 'MERGED2014_15_PP.csv')

school_2016 <- read.csv(file = 'MERGED2015_16_PP.csv')

school_2017 <- read.csv(file = 'MERGED2016_17_PP.csv')

school_2018 <- read.csv(file = 'Most-Recent-Cohorts-All-Data-Elements.csv')
```

Once our csvs have been read we then selected which attributes we wanted to examine. We wanted to focus our analysis around a few possible topics. The attributes we selected were graduation rates for each college by race and income brackets as defined by FAFSA, the mean and median pay of undergraduates with a degree, the average monthly pay of faculty, loan rates per college, percent of students who made a payment towards their student loan in the first three years, mean debt, an ID value assigned  by the US Department of Education, mean yearly cost of attending the school, revenue made per student, and institution name. These attributes where selected from every data set from 2010 - 2018. 

We also created a small table called basic_info that selected information such as what academic field the school is known for (Decided by US Department of Education), school type (public, private for profit, and private for non profit), latitudinal coordinate, and longitudinal coordinate. This table was created as these attributes were not all present as far back as 2010. But they could be taken from the most current data set (2018) and then joined back into each data set from 2010 - 2018. This will eliminate null values in the earlier data sets of  2010 - 2016. 


```{R wrangle data, message=FALSE, warning=FALSE, include=TRUE}
library(tidyr)
library(dplyr)
school_2010_edit <- school_2010 %>%
  select("UNITID", "INSTNM","UGDS" ,"C100_4", "C150_4", "C150_4_WHITE", "C150_4_BLACK", "C150_4_HISP", "C150_4_ASIAN", "LO_INC_COMP_ORIG_YR4_RT", "MD_INC_COMP_ORIG_YR4_RT", "HI_INC_COMP_ORIG_YR4_RT", "MN_EARN_WNE_P10", "MD_EARN_WNE_P10", "GRAD_DEBT_MDN_SUPP", "RPY_3YR_RT", "PCTFLOAN", "COSTT4_A", "AVGFACSAL", "TUITFTE")

school_2011_edit <- school_2011 %>%
  select("UNITID", "INSTNM","UGDS" ,"C100_4", "C150_4", "C150_4_WHITE", "C150_4_BLACK", "C150_4_HISP", "C150_4_ASIAN", "LO_INC_COMP_ORIG_YR4_RT", "MD_INC_COMP_ORIG_YR4_RT", "HI_INC_COMP_ORIG_YR4_RT", "MN_EARN_WNE_P10", "MD_EARN_WNE_P10", "GRAD_DEBT_MDN_SUPP", "RPY_3YR_RT", "PCTFLOAN", "COSTT4_A", "AVGFACSAL", "TUITFTE")

school_2012_edit <- school_2012 %>%
  select("UNITID", "INSTNM","UGDS" ,"C100_4", "C150_4", "C150_4_WHITE", "C150_4_BLACK", "C150_4_HISP", "C150_4_ASIAN", "LO_INC_COMP_ORIG_YR4_RT", "MD_INC_COMP_ORIG_YR4_RT", "HI_INC_COMP_ORIG_YR4_RT", "MN_EARN_WNE_P10", "MD_EARN_WNE_P10", "GRAD_DEBT_MDN_SUPP", "RPY_3YR_RT", "PCTFLOAN", "COSTT4_A", "AVGFACSAL", "TUITFTE")

school_2013_edit <- school_2013 %>%
  select("UNITID", "INSTNM","UGDS" ,"C100_4", "C150_4", "C150_4_WHITE", "C150_4_BLACK", "C150_4_HISP", "C150_4_ASIAN", "LO_INC_COMP_ORIG_YR4_RT", "MD_INC_COMP_ORIG_YR4_RT", "HI_INC_COMP_ORIG_YR4_RT", "MN_EARN_WNE_P10", "MD_EARN_WNE_P10", "GRAD_DEBT_MDN_SUPP", "RPY_3YR_RT", "PCTFLOAN", "COSTT4_A", "AVGFACSAL", "TUITFTE")

school_2014_edit <- school_2014 %>%
  select("UNITID", "INSTNM","UGDS" ,"C100_4", "C150_4", "C150_4_WHITE", "C150_4_BLACK", "C150_4_HISP", "C150_4_ASIAN", "LO_INC_COMP_ORIG_YR4_RT", "MD_INC_COMP_ORIG_YR4_RT", "HI_INC_COMP_ORIG_YR4_RT", "MN_EARN_WNE_P10", "MD_EARN_WNE_P10", "GRAD_DEBT_MDN_SUPP", "RPY_3YR_RT", "PCTFLOAN", "COSTT4_A", "AVGFACSAL", "TUITFTE")

school_2015_edit <- school_2015 %>%
  select("UNITID", "INSTNM","UGDS" ,"C100_4", "C150_4", "C150_4_WHITE", "C150_4_BLACK", "C150_4_HISP", "C150_4_ASIAN", "LO_INC_COMP_ORIG_YR4_RT", "MD_INC_COMP_ORIG_YR4_RT", "HI_INC_COMP_ORIG_YR4_RT", "MN_EARN_WNE_P10", "MD_EARN_WNE_P10", "GRAD_DEBT_MDN_SUPP", "RPY_3YR_RT", "PCTFLOAN", "COSTT4_A", "AVGFACSAL", "TUITFTE")

school_2016_edit <- school_2016 %>%
  select("UNITID", "INSTNM","UGDS" ,"C100_4", "C150_4", "C150_4_WHITE", "C150_4_BLACK", "C150_4_HISP", "C150_4_ASIAN", "LO_INC_COMP_ORIG_YR4_RT", "MD_INC_COMP_ORIG_YR4_RT", "HI_INC_COMP_ORIG_YR4_RT", "MN_EARN_WNE_P10", "MD_EARN_WNE_P10", "GRAD_DEBT_MDN_SUPP", "RPY_3YR_RT", "PCTFLOAN", "COSTT4_A", "AVGFACSAL", "TUITFTE")

school_2017_edit <- school_2017 %>%
  select("UNITID", "INSTNM","UGDS" ,"C100_4", "C150_4", "C150_4_WHITE", "C150_4_BLACK", "C150_4_HISP", "C150_4_ASIAN", "LO_INC_COMP_ORIG_YR4_RT", "MD_INC_COMP_ORIG_YR4_RT", "HI_INC_COMP_ORIG_YR4_RT", "MN_EARN_WNE_P10", "MD_EARN_WNE_P10", "GRAD_DEBT_MDN_SUPP", "RPY_3YR_RT", "PCTFLOAN", "COSTT4_A", "AVGFACSAL", "TUITFTE")

school_2018_edit <- school_2018 %>%
  select("UNITID", "INSTNM","UGDS" ,"C100_4", "C150_4", "C150_4_WHITE", "C150_4_BLACK", "C150_4_HISP", "C150_4_ASIAN", "LO_INC_COMP_ORIG_YR4_RT", "MD_INC_COMP_ORIG_YR4_RT", "HI_INC_COMP_ORIG_YR4_RT", "MN_EARN_WNE_P10", "MD_EARN_WNE_P10", "GRAD_DEBT_MDN_SUPP", "RPY_3YR_RT", "PCTFLOAN", "COSTT4_A", "AVGFACSAL", "TUITFTE")

basic_info <- school_2017%>%
    select("UNITID", "CCBASIC","LATITUDE", "LONGITUDE", "CONTROL")
  
```

Once each year has their selected data we then rename the attributes from there US Department of Education encoding to more meaningful names so that the information is easier to understand and follow. This was done by using the rename function. 


```{R rename data, message=FALSE, warning=FALSE, include=TRUE}

basic_info <- basic_info%>%
        rename("id" = "UNITID", "base_class" = "CCBASIC", "lat" = "LATITUDE", "lgn" = "LONGITUDE", "type" = "CONTROL")

 school_2010_edit <- school_2010_edit%>%
  rename("comp_in_4" = "C100_4", "comp_in_6" = "C150_4", "comp_in_4_white" = "C150_4_WHITE", "comp_in_4_black" = "C150_4_BLACK", "comp_in_4_hisp" = "C150_4_HISP","comp_in_4_asian" = "C150_4_ASIAN", "comp_in_4_lo" = "LO_INC_COMP_ORIG_YR4_RT", "comp_in_4_md" = "MD_INC_COMP_ORIG_YR4_RT", "comp_in_4_hi" = "HI_INC_COMP_ORIG_YR4_RT", "avg_earning" = "MN_EARN_WNE_P10", "med_earning" = "MD_EARN_WNE_P10", "avg_debt" = "GRAD_DEBT_MDN_SUPP", "payed_loan_within_3_years" = "RPY_3YR_RT", "took_loan" = "PCTFLOAN", "avg_year_cost" = "COSTT4_A", "id" = "UNITID", "school" = "INSTNM", "rev_per_student" = "TUITFTE", "avg_fac_sal_month" = "AVGFACSAL")
 
  school_2011_edit <- school_2011_edit%>%
  rename("comp_in_4" = "C100_4", "comp_in_6" = "C150_4", "comp_in_4_white" = "C150_4_WHITE", "comp_in_4_black" = "C150_4_BLACK", "comp_in_4_hisp" = "C150_4_HISP","comp_in_4_asian" = "C150_4_ASIAN", "comp_in_4_lo" = "LO_INC_COMP_ORIG_YR4_RT", "comp_in_4_md" = "MD_INC_COMP_ORIG_YR4_RT", "comp_in_4_hi" = "HI_INC_COMP_ORIG_YR4_RT", "avg_earning" = "MN_EARN_WNE_P10", "med_earning" = "MD_EARN_WNE_P10", "avg_debt" = "GRAD_DEBT_MDN_SUPP", "payed_loan_within_3_years" = "RPY_3YR_RT", "took_loan" = "PCTFLOAN", "avg_year_cost" = "COSTT4_A", "id" = "UNITID", "school" = "INSTNM", "rev_per_student" = "TUITFTE", "avg_fac_sal_month" = "AVGFACSAL")
  
   school_2012_edit <- school_2012_edit%>%
  rename("comp_in_4" = "C100_4", "comp_in_6" = "C150_4", "comp_in_4_white" = "C150_4_WHITE", "comp_in_4_black" = "C150_4_BLACK", "comp_in_4_hisp" = "C150_4_HISP","comp_in_4_asian" = "C150_4_ASIAN", "comp_in_4_lo" = "LO_INC_COMP_ORIG_YR4_RT", "comp_in_4_md" = "MD_INC_COMP_ORIG_YR4_RT", "comp_in_4_hi" = "HI_INC_COMP_ORIG_YR4_RT", "avg_earning" = "MN_EARN_WNE_P10", "med_earning" = "MD_EARN_WNE_P10", "avg_debt" = "GRAD_DEBT_MDN_SUPP", "payed_loan_within_3_years" = "RPY_3YR_RT", "took_loan" = "PCTFLOAN", "avg_year_cost" = "COSTT4_A", "id" = "UNITID", "school" = "INSTNM", "rev_per_student" = "TUITFTE", "avg_fac_sal_month" = "AVGFACSAL")
   
    school_2013_edit <- school_2013_edit%>%
  rename("comp_in_4" = "C100_4", "comp_in_6" = "C150_4", "comp_in_4_white" = "C150_4_WHITE", "comp_in_4_black" = "C150_4_BLACK", "comp_in_4_hisp" = "C150_4_HISP","comp_in_4_asian" = "C150_4_ASIAN", "comp_in_4_lo" = "LO_INC_COMP_ORIG_YR4_RT", "comp_in_4_md" = "MD_INC_COMP_ORIG_YR4_RT", "comp_in_4_hi" = "HI_INC_COMP_ORIG_YR4_RT", "avg_earning" = "MN_EARN_WNE_P10", "med_earning" = "MD_EARN_WNE_P10", "avg_debt" = "GRAD_DEBT_MDN_SUPP", "payed_loan_within_3_years" = "RPY_3YR_RT", "took_loan" = "PCTFLOAN", "avg_year_cost" = "COSTT4_A", "id" = "UNITID", "school" = "INSTNM", "rev_per_student" = "TUITFTE", "avg_fac_sal_month" = "AVGFACSAL")
    
     school_2014_edit <- school_2014_edit%>%
  rename("comp_in_4" = "C100_4", "comp_in_6" = "C150_4", "comp_in_4_white" = "C150_4_WHITE", "comp_in_4_black" = "C150_4_BLACK", "comp_in_4_hisp" = "C150_4_HISP","comp_in_4_asian" = "C150_4_ASIAN", "comp_in_4_lo" = "LO_INC_COMP_ORIG_YR4_RT", "comp_in_4_md" = "MD_INC_COMP_ORIG_YR4_RT", "comp_in_4_hi" = "HI_INC_COMP_ORIG_YR4_RT", "avg_earning" = "MN_EARN_WNE_P10", "med_earning" = "MD_EARN_WNE_P10", "avg_debt" = "GRAD_DEBT_MDN_SUPP", "payed_loan_within_3_years" = "RPY_3YR_RT", "took_loan" = "PCTFLOAN", "avg_year_cost" = "COSTT4_A", "id" = "UNITID", "school" = "INSTNM", "rev_per_student" = "TUITFTE", "avg_fac_sal_month" = "AVGFACSAL")
     
      school_2015_edit <- school_2015_edit%>%
  rename("comp_in_4" = "C100_4", "comp_in_6" = "C150_4", "comp_in_4_white" = "C150_4_WHITE", "comp_in_4_black" = "C150_4_BLACK", "comp_in_4_hisp" = "C150_4_HISP","comp_in_4_asian" = "C150_4_ASIAN", "comp_in_4_lo" = "LO_INC_COMP_ORIG_YR4_RT", "comp_in_4_md" = "MD_INC_COMP_ORIG_YR4_RT", "comp_in_4_hi" = "HI_INC_COMP_ORIG_YR4_RT", "avg_earning" = "MN_EARN_WNE_P10", "med_earning" = "MD_EARN_WNE_P10", "avg_debt" = "GRAD_DEBT_MDN_SUPP", "payed_loan_within_3_years" = "RPY_3YR_RT", "took_loan" = "PCTFLOAN", "avg_year_cost" = "COSTT4_A", "id" = "UNITID", "school" = "INSTNM", "rev_per_student" = "TUITFTE", "avg_fac_sal_month" = "AVGFACSAL")
      
       school_2016_edit <- school_2016_edit%>%
  rename("comp_in_4" = "C100_4", "comp_in_6" = "C150_4", "comp_in_4_white" = "C150_4_WHITE", "comp_in_4_black" = "C150_4_BLACK", "comp_in_4_hisp" = "C150_4_HISP","comp_in_4_asian" = "C150_4_ASIAN", "comp_in_4_lo" = "LO_INC_COMP_ORIG_YR4_RT", "comp_in_4_md" = "MD_INC_COMP_ORIG_YR4_RT", "comp_in_4_hi" = "HI_INC_COMP_ORIG_YR4_RT", "avg_earning" = "MN_EARN_WNE_P10", "med_earning" = "MD_EARN_WNE_P10", "avg_debt" = "GRAD_DEBT_MDN_SUPP", "payed_loan_within_3_years" = "RPY_3YR_RT", "took_loan" = "PCTFLOAN", "avg_year_cost" = "COSTT4_A", "id" = "UNITID", "school" = "INSTNM", "rev_per_student" = "TUITFTE", "avg_fac_sal_month" = "AVGFACSAL")

 school_2017_edit <- school_2017_edit%>%
  rename("comp_in_4" = "C100_4", "comp_in_6" = "C150_4", "comp_in_4_white" = "C150_4_WHITE", "comp_in_4_black" = "C150_4_BLACK", "comp_in_4_hisp" = "C150_4_HISP", "comp_in_4_asian" = "C150_4_ASIAN", "comp_in_4_lo" = "LO_INC_COMP_ORIG_YR4_RT", "comp_in_4_md" = "MD_INC_COMP_ORIG_YR4_RT", "comp_in_4_hi" = "HI_INC_COMP_ORIG_YR4_RT", "avg_earning" = "MN_EARN_WNE_P10", "med_earning" = "MD_EARN_WNE_P10", "avg_debt" = "GRAD_DEBT_MDN_SUPP", "payed_loan_within_3_years" = "RPY_3YR_RT", "took_loan" = "PCTFLOAN", "avg_year_cost" = "COSTT4_A", "id" = "UNITID", "school" = "INSTNM", "rev_per_student" = "TUITFTE", "avg_fac_sal_month" = "AVGFACSAL")
 
  school_2018_edit <- school_2018_edit%>%
  rename("comp_in_4" = "C100_4", "comp_in_6" = "C150_4", "comp_in_4_white" = "C150_4_WHITE", "comp_in_4_black" = "C150_4_BLACK", "comp_in_4_hisp" = "C150_4_HISP", "comp_in_4_asian" = "C150_4_ASIAN", "comp_in_4_lo" = "LO_INC_COMP_ORIG_YR4_RT", "comp_in_4_md" = "MD_INC_COMP_ORIG_YR4_RT", "comp_in_4_hi" = "HI_INC_COMP_ORIG_YR4_RT", "avg_earning" = "MN_EARN_WNE_P10", "med_earning" = "MD_EARN_WNE_P10", "avg_debt" = "GRAD_DEBT_MDN_SUPP", "payed_loan_within_3_years" = "RPY_3YR_RT", "took_loan" = "PCTFLOAN", "avg_year_cost" = "COSTT4_A", "id" = "UNITID", "school" = "INSTNM", "rev_per_student" = "TUITFTE", "avg_fac_sal_month" = "AVGFACSAL")
```

Now that the data has been properly relabeled, we begin to create two new attributes called class_info and type_mod. The original attribute for class_info was base_class, it depicted what academic field each school was known for. But, base_class is given by an integer value. We converted each integer into a string to decode what each integer represented. For example, 1 is agriculture, 2 is agricultural science, and so on. Each value was decoded as defined by the US Depart of Education’s guidelines. A similar situation occurred in the attribute type. Type was encoded into three integers, 1 is public, 2 is private for profit, and 3 is private for non profit. Each value was decoded as defined by the US Depart of Education’s guidelines. These new attributes were created using the function mutate and case_when. Case_when is unique function that allowed us to setup multiple conditional statements and return values. So we are able to pair up each integer to its corresponding decoded string value.  


```{r wrangling basic info, message=FALSE, warning=FALSE, include=TRUE}
basic_info$base_class <- as.numeric(basic_info$base_class)

basic_info <- basic_info%>%
  mutate(class_info = case_when(base_class < 1 ~ 'none',
                                base_class == 1 ~ 'Agriculture',
                                base_class == 2 ~ 'Agriculture Sciences,',
                               base_class == 3 ~ 'Environmental Studies',
                                base_class == 4 ~ 'Architecture',
                                base_class == 5 ~ 'History, Cultural',
                                 base_class <= 9 ~ 'Communication',
                                base_class <= 10 ~ 'Communications Technology/Technician',
                                  base_class <= 11 ~ 'Computer and Information Sciences',
                                base_class <= 12 ~ 'Funeral Service and Mortuary Science',
                                base_class <= 13 ~ 'Education',
                                base_class <= 14 ~ 'Engineering',
                                base_class <= 15 ~ 'Engineering Technology',
                                base_class <= 16 ~ 'East Asian Languages, Literatures, and Linguistics',
                                base_class <= 19 ~ 'Work and Family Studies',
                                base_class <= 22 ~ 'Legal Studies',
                                base_class <= 23 ~ 'English Language and Literature',
                                 base_class <= 24 ~ 'Liberal Arts and Sciences',
                                 base_class <= 25 ~ 'Library and Information Science',
                                 base_class <= 26 ~ 'Biology/Biological Sciences',
                                 base_class <= 27 ~ 'Mathematics',
                                 base_class <= 28 ~ 'Air Science/Airpower Studies',
                                 base_class <= 29 ~ 'Intelligence, General',
                                 base_class <= 30 ~ 'Multi-/Interdisciplinary Studies',
                                 base_class <= 31 ~ 'Physical Education',
                                  base_class <= 38 ~ 'Philosophy and Religious Studies',
                                  base_class <= 39 ~ 'Religious Education',
                                  base_class <= 40 ~ 'Physical Sciences',
                                  base_class <= 41 ~ 'Biotechnology Laboratory Technician.',
                                  base_class <= 42 ~ 'Psychology',
                                  base_class <= 43 ~ 'Criminal Studies',
                                  base_class <= 44 ~ 'Human Services',
                                  base_class <= 45 ~ 'Social Sciences',
                                  base_class <= 46 ~ 'Construction Trades',
                                  base_class <= 47 ~ 'Mechanics and Repairers',
                                  base_class <= 48 ~ 'Precision Production Trades',
                                  base_class <= 49 ~ 'Aeronautics/Aviation/Aerospace Science and Technology',
                                  base_class <= 50 ~ 'Digital Arts',
                                  base_class <= 51 ~ 'Health Services/Health Sciences',
                                  base_class <= 52 ~ 'Business/Commerce, General',
                                  base_class <= 54 ~ 'History, General',
                                
                                  TRUE ~ 'none'))

basic_info <- basic_info%>%
  mutate(type_mod = case_when(type == 1 ~ 'public',
                              type == 2 ~ 'private for profit',
                              type == 3 ~ 'private non profit'))
```

As stated previously, each data set from 2010 - 2018 was inner joined on ID with basic_info. Basic_info contained attributed such as latitude, longitude, type, and class_info. Many of these attributes were missing in the earlier data sets. To avoid null values each data set was given its school most recent information on these attributes.  


```{r inner join basic info, message=FALSE, warning=FALSE, include=TRUE}
school_2010_edit<- school_2010_edit %>%
  inner_join(basic_info, by="id")

school_2011_edit<- school_2011_edit %>%
  inner_join(basic_info, by="id")

school_2012_edit<- school_2012_edit %>%
  inner_join(basic_info, by="id")

school_2013_edit<- school_2013_edit %>%
  inner_join(basic_info, by="id")

school_2014_edit<- school_2014_edit %>%
  inner_join(basic_info, by="id")

school_2015_edit<- school_2015_edit %>%
  inner_join(basic_info, by="id")

school_2016_edit<- school_2016_edit %>%
  inner_join(basic_info, by="id")

school_2017_edit<- school_2017_edit %>%
  inner_join(basic_info, by="id")

school_2018_edit<- school_2018_edit %>%
  inner_join(basic_info, by="id")

```

#Data Management 
Next we begin to clean up and wrangle the data sets. The data set has the string value “NULL” located throughout it. Each “NULL” value was changed to the appropriate NA value so that null values could be removed when examining and analyzing the data. Next we begin to change each attributes type so that they can be analysed. All of the number values are of type integer but they need to be converted to numerics. Non rational integer values were changed with the function as.Numeric(Dat_set$Attribute). All of the rational attributes were scanned in as integers, because rational values are not contained in the set of Integers, when they get converted to a numeric, they become whole numbers. To fix this issue the rational attributes were first converted into a string and then into a numeric. This allowed the rational attributes to remain rational. Now all of our attributes are correctly typed. This allows them to be used in functions like ggplot. Aditional information on tidying data can be found [here](http://www.hcbravo.org/IntroDataSci/bookdown-notes/eda-handling-missing-data.html).

We also created four new attributes. The first is took_no_loan. This is the percent of students who didn't take a loan. It was calculated by subtracting the percent of students who did take a loan from 1. The second was average faculty salary by year. This was calculated by multiplying 12 and the average faculty salary by month. The third was the percent of students who defaulted on their loan. This was calculated by subtracting the percent of students who made a payment on there loan within the first three years from 1. The last attribute was undergrad revenue. This was calculated by multiplying the total amount of undergraduates by the revenue made per student.

This data cleaning and wrangling was completed for all the data sets 2010 - 2018. Also, as noted above, all null values are removed when they get analyzed and examined. 


```{r wrangle all years, message=FALSE, warning=FALSE, include=TRUE}

school_2010_edit[school_2010_edit == "NULL"] <- NA
 
school_2010_edit$avg_fac_sal_month <- as.numeric(school_2010_edit$avg_fac_sal_month)

school_2010_edit$payed_loan_within_3_years <- as.character(school_2010_edit$payed_loan_within_3_years)
school_2010_edit$payed_loan_within_3_years <- as.numeric(school_2010_edit$payed_loan_within_3_years)

school_2010_edit$rev_per_student <- as.numeric(school_2010_edit$rev_per_student)
school_2010_edit$UGDS <- as.numeric(school_2010_edit$UGDS)

school_2010_edit$comp_in_4 <- as.character(school_2010_edit$comp_in_4)
school_2010_edit$comp_in_4 <- as.numeric(school_2010_edit$comp_in_4)

school_2010_edit$comp_in_6 <- as.character(school_2010_edit$comp_in_6)
school_2010_edit$comp_in_6 <- as.numeric(school_2010_edit$comp_in_6)

school_2010_edit$comp_in_4_white <- as.character(school_2010_edit$comp_in_4_white)
school_2010_edit$comp_in_4_white <- as.numeric(school_2010_edit$comp_in_4_white)

school_2010_edit$comp_in_4_black <- as.character(school_2010_edit$comp_in_4_black)
school_2010_edit$comp_in_4_black <- as.numeric(school_2010_edit$comp_in_4_black)

school_2010_edit$comp_in_4_hisp <- as.character(school_2010_edit$comp_in_4_hisp)
school_2010_edit$comp_in_4_hisp <- as.numeric(school_2010_edit$comp_in_4_hisp)

school_2010_edit$comp_in_4_asian <- as.character(school_2010_edit$comp_in_4_asian)
school_2010_edit$comp_in_4_asian <- as.numeric(school_2010_edit$comp_in_4_asian)

school_2010_edit$comp_in_4_lo <- as.character(school_2010_edit$comp_in_4_lo)
school_2010_edit$comp_in_4_lo <- as.numeric(school_2010_edit$comp_in_4_lo)

school_2010_edit$comp_in_4_md <- as.character(school_2010_edit$comp_in_4_md)
school_2010_edit$comp_in_4_md <- as.numeric(school_2010_edit$comp_in_4_md)

school_2010_edit$comp_in_4_hi <- as.character(school_2010_edit$comp_in_4_hi)
school_2010_edit$comp_in_4_hi <- as.numeric(school_2010_edit$comp_in_4_hi)

school_2010_edit$avg_earning <- as.character(school_2010_edit$avg_earning)
school_2010_edit$avg_earning <- as.numeric(school_2010_edit$avg_earning)
 
school_2010_edit$med_earning <- as.character(school_2010_edit$med_earning)
school_2010_edit$med_earning<- as.numeric(school_2010_edit$med_earning)
 
school_2010_edit$avg_debt <- as.character(school_2010_edit$avg_debt)
school_2010_edit$avg_debt <- as.numeric(school_2010_edit$avg_debt)

school_2010_edit$took_loan <- as.character(school_2010_edit$took_loan)
school_2010_edit$took_loan <- as.numeric(school_2010_edit$took_loan)

school_2010_edit <- mutate(school_2010_edit, "took_no_loan" = 1 - took_loan)
school_2010_edit <- mutate(school_2010_edit, "avg_fac_sal_year" = avg_fac_sal_month * 12)
school_2010_edit <- mutate(school_2010_edit, "defualt_on_loab" = 1 - payed_loan_within_3_years)
school_2010_edit <- mutate(school_2010_edit, "undergrade_rev" = UGDS * rev_per_student)


##2011

school_2011_edit[school_2011_edit == "NULL"] <- NA

school_2011_edit$avg_fac_sal_month <- as.numeric(school_2011_edit$avg_fac_sal_month)

school_2011_edit$payed_loan_within_3_years <- as.character(school_2011_edit$payed_loan_within_3_years)
school_2011_edit$payed_loan_within_3_years <- as.numeric(school_2011_edit$payed_loan_within_3_years)

school_2011_edit$rev_per_student <- as.numeric(school_2011_edit$rev_per_student)
school_2011_edit$UGDS <- as.numeric(school_2011_edit$UGDS)

school_2011_edit$comp_in_4 <- as.character(school_2011_edit$comp_in_4)
school_2011_edit$comp_in_4 <- as.numeric(school_2011_edit$comp_in_4)

school_2011_edit$comp_in_6 <- as.character(school_2011_edit$comp_in_6)
school_2011_edit$comp_in_6 <- as.numeric(school_2011_edit$comp_in_6)

school_2011_edit$comp_in_4_white <- as.character(school_2011_edit$comp_in_4_white)
school_2011_edit$comp_in_4_white <- as.numeric(school_2011_edit$comp_in_4_white)

school_2011_edit$comp_in_4_black <- as.character(school_2011_edit$comp_in_4_black)
school_2011_edit$comp_in_4_black <- as.numeric(school_2011_edit$comp_in_4_black)

school_2011_edit$comp_in_4_hisp <- as.character(school_2011_edit$comp_in_4_hisp)
school_2011_edit$comp_in_4_hisp <- as.numeric(school_2011_edit$comp_in_4_hisp)

school_2011_edit$comp_in_4_asian <- as.character(school_2011_edit$comp_in_4_asian)
school_2011_edit$comp_in_4_asian <- as.numeric(school_2011_edit$comp_in_4_asian)

school_2011_edit$comp_in_4_lo <- as.character(school_2011_edit$comp_in_4_lo)
school_2011_edit$comp_in_4_lo <- as.numeric(school_2011_edit$comp_in_4_lo)

school_2011_edit$comp_in_4_md <- as.character(school_2011_edit$comp_in_4_md)
school_2011_edit$comp_in_4_md <- as.numeric(school_2011_edit$comp_in_4_md)

school_2011_edit$comp_in_4_hi <- as.character(school_2011_edit$comp_in_4_hi)
school_2011_edit$comp_in_4_hi <- as.numeric(school_2011_edit$comp_in_4_hi)

school_2011_edit$avg_earning <- as.character(school_2011_edit$avg_earning)
school_2011_edit$avg_earning <- as.numeric(school_2011_edit$avg_earning)
 
school_2011_edit$med_earning <- as.character(school_2011_edit$med_earning)
school_2011_edit$med_earning <- as.numeric(school_2011_edit$med_earning)
 
school_2011_edit$avg_debt<- as.character(school_2011_edit$avg_debt)
school_2011_edit$avg_debt <- as.numeric(school_2011_edit$avg_debt)

school_2011_edit$took_loan <- as.character(school_2011_edit$took_loan)
school_2011_edit$took_loan <- as.numeric(school_2011_edit$took_loan)

school_2011_edit <- mutate(school_2011_edit, "took_no_loan" = 1 - took_loan)
school_2011_edit <- mutate(school_2011_edit, "avg_fac_sal_year" = avg_fac_sal_month * 12)
school_2011_edit <- mutate(school_2011_edit, "defualt_on_loab" = 1 - payed_loan_within_3_years)
school_2011_edit <- mutate(school_2011_edit, "undergrade_rev" = UGDS * rev_per_student)


##2012


school_2012_edit[school_2012_edit == "NULL"] <- NA

school_2012_edit$avg_fac_sal_month <- as.numeric(school_2012_edit$avg_fac_sal_month)

school_2012_edit$payed_loan_within_3_years <- as.character(school_2012_edit$payed_loan_within_3_years)
school_2012_edit$payed_loan_within_3_years <- as.numeric(school_2012_edit$payed_loan_within_3_years)

school_2012_edit$rev_per_student <- as.numeric(school_2012_edit$rev_per_student)
school_2012_edit$UGDS <- as.numeric(school_2012_edit$UGDS)

school_2012_edit$comp_in_4 <- as.character(school_2012_edit$comp_in_4)
school_2012_edit$comp_in_4 <- as.numeric(school_2012_edit$comp_in_4)

school_2012_edit$comp_in_6 <- as.character(school_2012_edit$comp_in_6)
school_2012_edit$comp_in_6 <- as.numeric(school_2012_edit$comp_in_6)

school_2012_edit$comp_in_4_white <- as.character(school_2012_edit$comp_in_4_white)
school_2012_edit$comp_in_4_white <- as.numeric(school_2012_edit$comp_in_4_white)

school_2012_edit$comp_in_4_black <- as.character(school_2012_edit$comp_in_4_black)
school_2012_edit$comp_in_4_black <- as.numeric(school_2012_edit$comp_in_4_black)

school_2012_edit$comp_in_4_hisp <- as.character(school_2012_edit$comp_in_4_hisp)
school_2012_edit$comp_in_4_hisp <- as.numeric(school_2012_edit$comp_in_4_hisp)

school_2012_edit$comp_in_4_asian <- as.character(school_2012_edit$comp_in_4_asian)
school_2012_edit$comp_in_4_asian <- as.numeric(school_2012_edit$comp_in_4_asian)

school_2012_edit$comp_in_4_lo <- as.character(school_2012_edit$comp_in_4_lo)
school_2012_edit$comp_in_4_lo <- as.numeric(school_2012_edit$comp_in_4_lo)

school_2012_edit$comp_in_4_md <- as.character(school_2012_edit$comp_in_4_md)
school_2012_edit$comp_in_4_md <- as.numeric(school_2012_edit$comp_in_4_md)

school_2012_edit$comp_in_4_hi <- as.character(school_2012_edit$comp_in_4_hi)
school_2012_edit$comp_in_4_hi <- as.numeric(school_2012_edit$comp_in_4_hi)

school_2012_edit$avg_earning <- as.character(school_2012_edit$avg_earning)
school_2012_edit$avg_earning <- as.numeric(school_2012_edit$avg_earning)
 
school_2012_edit$med_earning <- as.character(school_2012_edit$med_earning)
school_2012_edit$med_earning <- as.numeric(school_2012_edit$med_earning)
 
school_2012_edit$avg_debt <- as.character(school_2012_edit$avg_debt)
school_2012_edit$avg_debt <- as.numeric(school_2012_edit$avg_debt)

school_2012_edit$took_loan <- as.character(school_2012_edit$took_loan)
school_2012_edit$took_loan <- as.numeric(school_2012_edit$took_loan)

school_2012_edit <- mutate(school_2012_edit, "took_no_loan" = 1 - took_loan)
school_2012_edit <- mutate(school_2012_edit, "avg_fac_sal_year" = avg_fac_sal_month * 12)
school_2012_edit <- mutate(school_2012_edit, "defualt_on_loab" = 1 - payed_loan_within_3_years)
school_2012_edit <- mutate(school_2012_edit, "undergrade_rev" = UGDS * rev_per_student)



##2013


school_2013_edit[school_2013_edit == "NULL"] <- NA

school_2013_edit$avg_fac_sal_month <- as.numeric(school_2013_edit$avg_fac_sal_month)

school_2013_edit$payed_loan_within_3_years <- as.character(school_2013_edit$payed_loan_within_3_years)
school_2013_edit$payed_loan_within_3_years <- as.numeric(school_2013_edit$payed_loan_within_3_years)

school_2013_edit$rev_per_student <- as.numeric(school_2013_edit$rev_per_student)
school_2013_edit$UGDS <- as.numeric(school_2013_edit$UGDS)

school_2013_edit$comp_in_4 <- as.character(school_2013_edit$comp_in_4)
school_2013_edit$comp_in_4 <- as.numeric(school_2013_edit$comp_in_4)

school_2013_edit$comp_in_6 <- as.character(school_2013_edit$comp_in_6)
school_2013_edit$comp_in_6 <- as.numeric(school_2013_edit$comp_in_6)

school_2013_edit$comp_in_4_white <- as.character(school_2013_edit$comp_in_4_white)
school_2013_edit$comp_in_4_white <- as.numeric(school_2013_edit$comp_in_4_white)

school_2013_edit$comp_in_4_black <- as.character(school_2013_edit$comp_in_4_black)
school_2013_edit$comp_in_4_black <- as.numeric(school_2013_edit$comp_in_4_black)

school_2013_edit$comp_in_4_hisp <- as.character(school_2013_edit$comp_in_4_hisp)
school_2013_edit$comp_in_4_hisp <- as.numeric(school_2013_edit$comp_in_4_hisp)

school_2013_edit$comp_in_4_asian <- as.character(school_2013_edit$comp_in_4_asian)
school_2013_edit$comp_in_4_asian <- as.numeric(school_2013_edit$comp_in_4_asian)

school_2013_edit$comp_in_4_lo <- as.character(school_2013_edit$comp_in_4_lo)
school_2013_edit$comp_in_4_lo <- as.numeric(school_2013_edit$comp_in_4_lo)

school_2013_edit$comp_in_4_md <- as.character(school_2013_edit$comp_in_4_md)
school_2013_edit$comp_in_4_md <- as.numeric(school_2013_edit$comp_in_4_md)

school_2013_edit$comp_in_4_hi <- as.character(school_2013_edit$comp_in_4_hi)
school_2013_edit$comp_in_4_hi <- as.numeric(school_2013_edit$comp_in_4_hi)

school_2013_edit$avg_earning <- as.character(school_2013_edit$avg_earning)
school_2013_edit$avg_earning <- as.numeric(school_2013_edit$avg_earning)
 
school_2013_edit$med_earning <- as.character(school_2013_edit$med_earning)
school_2013_edit$med_earning<- as.numeric(school_2013_edit$med_earning)
 
school_2013_edit$avg_debt <- as.character(school_2013_edit$avg_debt)
school_2013_edit$avg_debt <- as.numeric(school_2013_edit$avg_debt)

school_2013_edit$took_loan <- as.character(school_2013_edit$took_loan)
school_2013_edit$took_loan <- as.numeric(school_2013_edit$took_loan)

school_2013_edit <- mutate(school_2013_edit, "took_no_loan" = 1 - took_loan)
school_2013_edit <- mutate(school_2013_edit, "avg_fac_sal_year" = avg_fac_sal_month * 12)
school_2013_edit <- mutate(school_2013_edit, "defualt_on_loab" = 1 - payed_loan_within_3_years)
school_2013_edit <- mutate(school_2013_edit, "undergrade_rev" = UGDS * rev_per_student)


##2014


school_2014_edit[school_2014_edit == "NULL"] <- NA

school_2014_edit$avg_fac_sal_month <- as.numeric(school_2014_edit$avg_fac_sal_month)

school_2014_edit$payed_loan_within_3_years <- as.character(school_2014_edit$payed_loan_within_3_years)
school_2014_edit$payed_loan_within_3_years <- as.numeric(school_2014_edit$payed_loan_within_3_years)

school_2014_edit$rev_per_student <- as.numeric(school_2014_edit$rev_per_student)
school_2014_edit$UGDS <- as.numeric(school_2014_edit$UGDS)

school_2014_edit$comp_in_4 <- as.character(school_2014_edit$comp_in_4)
school_2014_edit$comp_in_4 <- as.numeric(school_2014_edit$comp_in_4)

school_2014_edit$comp_in_6 <- as.character(school_2014_edit$comp_in_6)
school_2014_edit$comp_in_6 <- as.numeric(school_2014_edit$comp_in_6)

school_2014_edit$comp_in_4_white <- as.character(school_2014_edit$comp_in_4_white)
school_2014_edit$comp_in_4_white <- as.numeric(school_2014_edit$comp_in_4_white)

school_2014_edit$comp_in_4_black <- as.character(school_2014_edit$comp_in_4_black)
school_2014_edit$comp_in_4_black <- as.numeric(school_2014_edit$comp_in_4_black)

school_2014_edit$comp_in_4_hisp <- as.character(school_2014_edit$comp_in_4_hisp)
school_2014_edit$comp_in_4_hisp <- as.numeric(school_2014_edit$comp_in_4_hisp)

school_2014_edit$comp_in_4_asian <- as.character(school_2014_edit$comp_in_4_asian)
school_2014_edit$comp_in_4_asian <- as.numeric(school_2014_edit$comp_in_4_asian)

school_2014_edit$comp_in_4_lo <- as.character(school_2014_edit$comp_in_4_lo)
school_2014_edit$comp_in_4_lo <- as.numeric(school_2014_edit$comp_in_4_lo)

school_2014_edit$comp_in_4_md <- as.character(school_2014_edit$comp_in_4_md)
school_2014_edit$comp_in_4_md <- as.numeric(school_2014_edit$comp_in_4_md)

school_2014_edit$comp_in_4_hi <- as.character(school_2014_edit$comp_in_4_hi)
school_2014_edit$comp_in_4_hi <- as.numeric(school_2014_edit$comp_in_4_hi)

school_2014_edit$avg_earning <- as.character(school_2014_edit$avg_earning)
school_2014_edit$avg_earning <- as.numeric(school_2014_edit$avg_earning)
 
school_2014_edit$med_earning <- as.character(school_2014_edit$med_earning)
school_2014_edit$med_earning<- as.numeric(school_2014_edit$med_earning)
 
school_2014_edit$avg_debt <- as.character(school_2014_edit$avg_debt)
school_2014_edit$avg_debt <- as.numeric(school_2014_edit$avg_debt)

school_2014_edit$took_loan <- as.character(school_2014_edit$took_loan)
school_2014_edit$took_loan <- as.numeric(school_2014_edit$took_loan)

school_2014_edit <- mutate(school_2014_edit, "took_no_loan" = 1 - took_loan)
school_2014_edit <- mutate(school_2014_edit, "avg_fac_sal_year" = avg_fac_sal_month * 12)
school_2014_edit <- mutate(school_2014_edit, "defualt_on_loab" = 1 - payed_loan_within_3_years)
school_2014_edit <- mutate(school_2014_edit, "undergrade_rev" = UGDS * rev_per_student)


##2015


school_2015_edit[school_2015_edit == "NULL"] <- NA

school_2015_edit$avg_fac_sal_month <- as.numeric(school_2015_edit$avg_fac_sal_month)

school_2015_edit$payed_loan_within_3_years <- as.character(school_2015_edit$payed_loan_within_3_years)
school_2015_edit$payed_loan_within_3_years <- as.numeric(school_2015_edit$payed_loan_within_3_years)

school_2015_edit$rev_per_student <- as.numeric(school_2015_edit$rev_per_student)
school_2015_edit$UGDS <- as.numeric(school_2015_edit$UGDS)

school_2015_edit$comp_in_4 <- as.character(school_2015_edit$comp_in_4)
school_2015_edit$comp_in_4 <- as.numeric(school_2015_edit$comp_in_4)

school_2015_edit$comp_in_6 <- as.character(school_2015_edit$comp_in_6)
school_2015_edit$comp_in_6 <- as.numeric(school_2015_edit$comp_in_6)

school_2015_edit$comp_in_4_white <- as.character(school_2015_edit$comp_in_4_white)
school_2015_edit$comp_in_4_white <- as.numeric(school_2015_edit$comp_in_4_white)

school_2015_edit$comp_in_4_black <- as.character(school_2015_edit$comp_in_4_black)
school_2015_edit$comp_in_4_black <- as.numeric(school_2015_edit$comp_in_4_black)

school_2015_edit$comp_in_4_hisp <- as.character(school_2015_edit$comp_in_4_hisp)
school_2015_edit$comp_in_4_hisp <- as.numeric(school_2015_edit$comp_in_4_hisp)

school_2015_edit$comp_in_4_asian <- as.character(school_2015_edit$comp_in_4_asian)
school_2015_edit$comp_in_4_asian <- as.numeric(school_2015_edit$comp_in_4_asian)

school_2015_edit$comp_in_4_lo <- as.character(school_2015_edit$comp_in_4_lo)
school_2015_edit$comp_in_4_lo <- as.numeric(school_2015_edit$comp_in_4_lo)

school_2015_edit$comp_in_4_md <- as.character(school_2015_edit$comp_in_4_md)
school_2015_edit$comp_in_4_md <- as.numeric(school_2015_edit$comp_in_4_md)

school_2015_edit$comp_in_4_hi <- as.character(school_2015_edit$comp_in_4_hi)
school_2015_edit$comp_in_4_hi <- as.numeric(school_2015_edit$comp_in_4_hi)

school_2015_edit$avg_earning <- as.character(school_2015_edit$avg_earning)
school_2015_edit$avg_earning <- as.numeric(school_2015_edit$avg_earning)
 
school_2015_edit$med_earning <- as.character(school_2015_edit$med_earning)
school_2015_edit$med_earning<- as.numeric(school_2015_edit$med_earning)
 
school_2015_edit$avg_debt <- as.character(school_2015_edit$avg_debt)
school_2015_edit$avg_debt <- as.numeric(school_2015_edit$avg_debt)

school_2015_edit$took_loan <- as.character(school_2015_edit$took_loan)
school_2015_edit$took_loan <- as.numeric(school_2015_edit$took_loan)

school_2015_edit <- mutate(school_2015_edit, "took_no_loan" = 1 - took_loan)
school_2015_edit <- mutate(school_2015_edit, "avg_fac_sal_year" = avg_fac_sal_month * 12)
school_2015_edit <- mutate(school_2015_edit, "defualt_on_loab" = 1 - payed_loan_within_3_years)
school_2015_edit <- mutate(school_2015_edit, "undergrade_rev" = UGDS * rev_per_student)

##2016


school_2016_edit[school_2016_edit == "NULL"] <- NA

school_2016_edit$avg_fac_sal_month <- as.numeric(school_2016_edit$avg_fac_sal_month)

school_2016_edit$payed_loan_within_3_years <- as.character(school_2016_edit$payed_loan_within_3_years)
school_2016_edit$payed_loan_within_3_years <- as.numeric(school_2016_edit$payed_loan_within_3_years)

school_2016_edit$rev_per_student <- as.numeric(school_2016_edit$rev_per_student)
school_2016_edit$UGDS <- as.numeric(school_2016_edit$UGDS)

school_2016_edit$comp_in_4 <- as.character(school_2016_edit$comp_in_4)
school_2016_edit$comp_in_4 <- as.numeric(school_2016_edit$comp_in_4)

school_2016_edit$comp_in_6 <- as.character(school_2016_edit$comp_in_6)
school_2016_edit$comp_in_6 <- as.numeric(school_2016_edit$comp_in_6)

school_2016_edit$comp_in_4_white <- as.character(school_2016_edit$comp_in_4_white)
school_2016_edit$comp_in_4_white <- as.numeric(school_2016_edit$comp_in_4_white)

school_2016_edit$comp_in_4_black <- as.character(school_2016_edit$comp_in_4_black)
school_2016_edit$comp_in_4_black <- as.numeric(school_2016_edit$comp_in_4_black)

school_2016_edit$comp_in_4_hisp <- as.character(school_2016_edit$comp_in_4_hisp)
school_2016_edit$comp_in_4_hisp <- as.numeric(school_2016_edit$comp_in_4_hisp)

school_2016_edit$comp_in_4_asian <- as.character(school_2016_edit$comp_in_4_asian)
school_2016_edit$comp_in_4_asian <- as.numeric(school_2016_edit$comp_in_4_asian)

school_2016_edit$comp_in_4_lo <- as.character(school_2016_edit$comp_in_4_lo)
school_2016_edit$comp_in_4_lo <- as.numeric(school_2016_edit$comp_in_4_lo)

school_2016_edit$comp_in_4_md <- as.character(school_2016_edit$comp_in_4_md)
school_2016_edit$comp_in_4_md <- as.numeric(school_2016_edit$comp_in_4_md)

school_2016_edit$comp_in_4_hi <- as.character(school_2016_edit$comp_in_4_hi)
school_2016_edit$comp_in_4_hi <- as.numeric(school_2016_edit$comp_in_4_hi)

school_2016_edit$avg_earning <- as.character(school_2016_edit$avg_earning)
school_2016_edit$avg_earning <- as.numeric(school_2016_edit$avg_earning)
 
school_2016_edit$med_earning <- as.character(school_2016_edit$med_earning)
school_2016_edit$med_earning<- as.numeric(school_2016_edit$med_earning)
 
school_2016_edit$avg_debt <- as.character(school_2016_edit$avg_debt)
school_2016_edit$avg_debt <- as.numeric(school_2016_edit$avg_debt)

school_2016_edit$took_loan <- as.character(school_2016_edit$took_loan)
school_2016_edit$took_loan <- as.numeric(school_2016_edit$took_loan)

school_2016_edit <- mutate(school_2016_edit, "took_no_loan" = 1 - took_loan)
school_2016_edit <- mutate(school_2016_edit, "avg_fac_sal_year" = avg_fac_sal_month * 12)
school_2016_edit <- mutate(school_2016_edit, "defualt_on_loab" = 1 - payed_loan_within_3_years)
school_2016_edit <- mutate(school_2016_edit, "undergrade_rev" = UGDS * rev_per_student)



##2017


school_2017_edit[school_2017_edit == "NULL"] <- NA

school_2017_edit$avg_fac_sal_month <- as.numeric(school_2017_edit$avg_fac_sal_month)

school_2017_edit$payed_loan_within_3_years <- as.character(school_2017_edit$payed_loan_within_3_years)
school_2017_edit$payed_loan_within_3_years <- as.numeric(school_2017_edit$payed_loan_within_3_years)

school_2017_edit$rev_per_student <- as.numeric(school_2017_edit$rev_per_student)
school_2017_edit$UGDS <- as.numeric(school_2017_edit$UGDS)

school_2017_edit$comp_in_4 <- as.character(school_2017_edit$comp_in_4)
school_2017_edit$comp_in_4 <- as.numeric(school_2017_edit$comp_in_4)

school_2017_edit$comp_in_6 <- as.character(school_2017_edit$comp_in_6)
school_2017_edit$comp_in_6 <- as.numeric(school_2017_edit$comp_in_6)

school_2017_edit$comp_in_4_white <- as.character(school_2017_edit$comp_in_4_white)
school_2017_edit$comp_in_4_white <- as.numeric(school_2017_edit$comp_in_4_white)

school_2017_edit$comp_in_4_black <- as.character(school_2017_edit$comp_in_4_black)
school_2017_edit$comp_in_4_black <- as.numeric(school_2017_edit$comp_in_4_black)

school_2017_edit$comp_in_4_hisp <- as.character(school_2017_edit$comp_in_4_hisp)
school_2017_edit$comp_in_4_hisp <- as.numeric(school_2017_edit$comp_in_4_hisp)

school_2017_edit$comp_in_4_asian <- as.character(school_2017_edit$comp_in_4_asian)
school_2017_edit$comp_in_4_asian <- as.numeric(school_2017_edit$comp_in_4_asian)

school_2017_edit$comp_in_4_lo <- as.character(school_2017_edit$comp_in_4_lo)
school_2017_edit$comp_in_4_lo <- as.numeric(school_2017_edit$comp_in_4_lo)

school_2017_edit$comp_in_4_md <- as.character(school_2017_edit$comp_in_4_md)
school_2017_edit$comp_in_4_md <- as.numeric(school_2017_edit$comp_in_4_md)

school_2017_edit$comp_in_4_hi <- as.character(school_2017_edit$comp_in_4_hi)
school_2017_edit$comp_in_4_hi <- as.numeric(school_2017_edit$comp_in_4_hi)

school_2017_edit$avg_earning <- as.character(school_2017_edit$avg_earning)
school_2017_edit$avg_earning <- as.numeric(school_2017_edit$avg_earning)
 
school_2017_edit$med_earning <- as.character(school_2017_edit$med_earning)
school_2017_edit$med_earning<- as.numeric(school_2017_edit$med_earning)
 
school_2017_edit$avg_debt <- as.character(school_2017_edit$avg_debt)
school_2017_edit$avg_debt <- as.numeric(school_2017_edit$avg_debt)

school_2017_edit$took_loan <- as.character(school_2017_edit$took_loan)
school_2017_edit$took_loan <- as.numeric(school_2017_edit$took_loan)

school_2017_edit <- mutate(school_2017_edit, "took_no_loan" = 1 - took_loan)
school_2017_edit <- mutate(school_2017_edit, "avg_fac_sal_year" = avg_fac_sal_month * 12)
school_2017_edit <- mutate(school_2017_edit, "defualt_on_loab" = 1 - payed_loan_within_3_years)
school_2017_edit <- mutate(school_2017_edit, "undergrade_rev" = UGDS * rev_per_student)


school_2018_edit[school_2018_edit == "NULL"] <- NA
 
school_2018_edit$avg_fac_sal_month <- as.numeric(school_2018_edit$avg_fac_sal_month)

school_2018_edit$payed_loan_within_3_years <- as.character(school_2018_edit$payed_loan_within_3_years)
school_2018_edit$payed_loan_within_3_years <- as.numeric(school_2018_edit$payed_loan_within_3_years)

school_2018_edit$rev_per_student <- as.numeric(school_2018_edit$rev_per_student)
school_2018_edit$UGDS <- as.numeric(school_2018_edit$UGDS)

school_2018_edit$comp_in_4 <- as.character(school_2018_edit$comp_in_4)
school_2018_edit$comp_in_4 <- as.numeric(school_2018_edit$comp_in_4)

school_2018_edit$comp_in_6 <- as.character(school_2018_edit$comp_in_6)
school_2018_edit$comp_in_6 <- as.numeric(school_2018_edit$comp_in_6)

school_2018_edit$comp_in_4_white <- as.character(school_2018_edit$comp_in_4_white)
school_2018_edit$comp_in_4_white <- as.numeric(school_2018_edit$comp_in_4_white)

school_2018_edit$comp_in_4_black <- as.character(school_2018_edit$comp_in_4_black)
school_2018_edit$comp_in_4_black <- as.numeric(school_2018_edit$comp_in_4_black)

school_2018_edit$comp_in_4_hisp <- as.character(school_2018_edit$comp_in_4_hisp)
school_2018_edit$comp_in_4_hisp <- as.numeric(school_2018_edit$comp_in_4_hisp)

school_2018_edit$comp_in_4_asian <- as.character(school_2018_edit$comp_in_4_asian)
school_2018_edit$comp_in_4_asian <- as.numeric(school_2018_edit$comp_in_4_asian)

school_2018_edit$comp_in_4_lo <- as.character(school_2018_edit$comp_in_4_lo)
school_2018_edit$comp_in_4_lo <- as.numeric(school_2018_edit$comp_in_4_lo)

school_2018_edit$comp_in_4_md <- as.character(school_2018_edit$comp_in_4_md)
school_2018_edit$comp_in_4_md <- as.numeric(school_2018_edit$comp_in_4_md)

school_2018_edit$comp_in_4_hi <- as.character(school_2018_edit$comp_in_4_hi)
school_2018_edit$comp_in_4_hi <- as.numeric(school_2018_edit$comp_in_4_hi)

school_2018_edit$avg_earning <- as.character(school_2018_edit$avg_earning)
school_2018_edit$avg_earning <- as.numeric(school_2018_edit$avg_earning)
 
school_2018_edit$med_earning <- as.character(school_2018_edit$med_earning)
school_2018_edit$med_earning<- as.numeric(school_2018_edit$med_earning)
 
school_2018_edit$avg_debt <- as.character(school_2018_edit$avg_debt)
school_2018_edit$avg_debt <- as.numeric(school_2018_edit$avg_debt)

school_2018_edit$took_loan <- as.character(school_2018_edit$took_loan)
school_2018_edit$took_loan <- as.numeric(school_2018_edit$took_loan)

school_2018_edit <- mutate(school_2018_edit, "took_no_loan" = 1 - took_loan)
school_2018_edit <- mutate(school_2018_edit, "avg_fac_sal_year" = avg_fac_sal_month * 12)
school_2018_edit <- mutate(school_2018_edit, "defualt_on_loab" = 1 - payed_loan_within_3_years)
school_2018_edit <- mutate(school_2018_edit, "undergrade_rev" = UGDS * rev_per_student)

school_2010_edit$avg_year_cost <- as.character(school_2010_edit$avg_year_cost)
school_2010_edit$avg_year_cost <- as.numeric(school_2010_edit$avg_year_cost)

school_2011_edit$avg_year_cost <- as.character(school_2011_edit$avg_year_cost)
school_2011_edit$avg_year_cost <- as.numeric(school_2011_edit$avg_year_cost)

school_2012_edit$avg_year_cost <- as.character(school_2012_edit$avg_year_cost)
school_2012_edit$avg_year_cost <- as.numeric(school_2012_edit$avg_year_cost)

school_2013_edit$avg_year_cost <- as.character(school_2013_edit$avg_year_cost)
school_2013_edit$avg_year_cost <- as.numeric(school_2013_edit$avg_year_cost)

school_2014_edit$avg_year_cost <- as.character(school_2014_edit$avg_year_cost)
school_2014_edit$avg_year_cost <- as.numeric(school_2014_edit$avg_year_cost)

school_2015_edit$avg_year_cost <- as.character(school_2015_edit$avg_year_cost)
school_2015_edit$avg_year_cost <- as.numeric(school_2015_edit$avg_year_cost)

school_2016_edit$avg_year_cost <- as.character(school_2016_edit$avg_year_cost)
school_2016_edit$avg_year_cost <- as.numeric(school_2016_edit$avg_year_cost)

school_2017_edit$avg_year_cost <- as.character(school_2017_edit$avg_year_cost)
school_2017_edit$avg_year_cost <- as.numeric(school_2017_edit$avg_year_cost)

school_2018_edit$avg_year_cost <- as.character(school_2018_edit$avg_year_cost)
school_2018_edit$avg_year_cost <- as.numeric(school_2018_edit$avg_year_cost)
```

Lastly we create a new attribute called year which labeled each observation by year. Then we created a master data set called combine. Combine placed all of our data into one massive data frame so that our analysis can be completed easier. To do this we used the function rbind which allows for the merging of data frames. 


```{r combine data into new year based fram, message=FALSE, warning=FALSE}
school_2010_edit <- mutate(school_2010_edit, "year" = 2010)
school_2011_edit <- mutate(school_2011_edit, "year" = 2011)
school_2012_edit <- mutate(school_2012_edit, "year" = 2012)
school_2013_edit <- mutate(school_2013_edit, "year" = 2013)
school_2014_edit <- mutate(school_2014_edit, "year" = 2014)
school_2015_edit <- mutate(school_2015_edit, "year" = 2015)
school_2016_edit <- mutate(school_2016_edit, "year" = 2016)
school_2017_edit <- mutate(school_2017_edit, "year" = 2017)
school_2018_edit <- mutate(school_2018_edit, "year" = 2018)
combine <- rbind(school_2010_edit, school_2011_edit,school_2012_edit, school_2013_edit,school_2014_edit,school_2015_edit,school_2016_edit,school_2017_edit, school_2018_edit)
```

# Exploratory Data Analysis

Lets begin data analysis by trying to find any correlations that exist in our dataset. Below we plot the average amount an undergraduate makes at each university vs. the average yearly cost to attend that university. Lets also add a linear regression line to see if this data is following any trends.

```{r ggplot avg yearly cost vs avg salary, message=FALSE, warning=FALSE}
combine %>%
  ggplot(aes(x=avg_year_cost, y=avg_earning)) +
    geom_point() +
    geom_smooth(method="lm")+
    labs(title="Avg Undergraduat salary vs Average Yearly Cost",
         x = "Avg Yearly Cost",
         y = "Avg Undergrad Salary")
```

From this graph we can see that on average when the average yearly cost of a university increases the amount that an undergraduate is going to get paid after college is higher. Lets explore some other correlations that might exist using different graphing techniques.


Below we will use a violin plot to determine the distribution of faculty salary based on the type of school they work at (public, private for profit, private not profit). 
```{r faculty salary vs type, message=FALSE, warning=FALSE}
combine %>%
  drop_na(avg_earning)%>%
  drop_na(avg_year_cost)%>%
  ggplot(aes(x=factor(type_mod), y=avg_fac_sal_year)) +
    geom_violin() +
    labs(title="Avg Faculty Salary vs Type of School Violin Plot",
         x = "Type of School",
         y = "Avg Faculty Salary")
```

Looking at the private for profit data we can see that for the most part the salary of faculty is evenly distributed across all pay ranges with a sligh decrease in the amount of peopel being paid around the \$10,000 range. This distribution is slightly bimodal because there is an increase of faculty being paid around less than \$10,000 range. For the private non profit data we can see that this data is unimodal with majority of staff being paid around the \$10,000 mark. The data is also skewed towards the upper pay salaries by quite a bit. The public universities have a very similar distribution to the private for profit schools with majority of the faculty making more than /$10,000 and a slight increase again slightly before 0. Overall from this data we can tell that the average faculty member of a private non profit school makes significanly less than a public school or private for profit school. Lets look at one more possible correlation.


Below we will examine the avrage salary of an undergrad graduate versus the average cost per year. We will also add coloring to separate each datapoint based on if it represents a public school grad, private for profit or private non profit grad. We will also add a linear regression line to examine if there is any correlation.
```{r message=FALSE, warning=FALSE}
combine %>%
  ggplot(aes(x=avg_year_cost, y=avg_earning, color = type_mod)) +
    geom_point() +
    geom_smooth(method="lm") +
    labs(title="Average Undergrad Salary vs. Avg year cost Colored By Type Of School",
         x = "Avg Yearly School Cost",
         y = "Avg Undergrad Salary")
```

From this graph we can see that there does seem to be an average linear increase between the average yearly school cost and average undergraduate salary after graduating. We can also see from the coloring of the graph that undergrads at different types of schools seem to follow separate linear patterns. We can see that the undergrad salary seems to increase more on average for public university students based on cost of attending vs. private for profit and private non profit schools. We will remember this later when performing linear analysis on this data. Next we will explore this data further to see if any linear relations do exit.

#Linear Analysis

Lets see if we can predict the average undergraduate salary of a school based on the average yearly cost of that school using a linear regression.

We will start by looking at the distributions of Average undergraduate salary vs. The type of school and the average yearly cost of the universities.

Below is the violin plot for the distribution of undergrad students based off of the average yearly cost of the school they attend clustered by cuts of around \$15,000. 
```{r message=FALSE, warning=FALSE}
combine %>%
  drop_na(avg_earning)%>%
  drop_na(avg_year_cost)%>%
  ggplot(aes(x=cut(avg_year_cost, breaks=5), y=avg_earning)) +
    geom_violin() +
    labs(title="Avg Undergrad Salary vs. Average Yearly Cost Violin Plot",
         x = "Average Yearly Cost",
         y = "Avg Undergrade Salary")
```

From this graph we can determine that the median undergraduate salary increaes based as the average salary yearly cost to attend incrases. Each distrigution is for the most part unimodal with a thin skew upwards indicating outliers. Based on this information we should be able to create an accurate linear model between average undergraduate salary and average yearly cost of a university.

Lets determine if there are any other factors that might be relevent to predicting average undergraduate salary based on average yearly cost of university. If you remember back to the scatter plot of average undergrad salary vs average yearly cost grouped by type of universty we saw there might be some differenes based on the type of university.

Below we will use a violin plot to graph the distribution of average undergraduate salary based on the type of school they attend.
```{r ggplot avg salary vs year, message=FALSE, warning=FALSE}
combine %>%
  drop_na(avg_earning)%>%
  drop_na(avg_year_cost)%>%
  ggplot(aes(x=factor(type_mod), y=avg_earning)) +
    geom_violin() +
    labs(title="Avg Undergrade Salary vs. Type of School Violin Plot",
         x = "Type of School",
         y = "Undergrade Salary")
```

From this plot you can see that the median average undergrad salary for each type of school between \$20,500 and \$40,500. The distributions for each school type is relativly unimodal and skewed upwards. The median average undergrad salary for each school type is different by slight amounts indicating that there could be some correlation between school type and average undergraduate salary. 

Below we will create three scatter plots to examine the linearity of average undergrad salary vs. average yearly cost of each university broken up by the type of school. Will also add a linear regression line to determine its linearity.

Here is the plots for public schools and private for profit schools.
```{r ggplot avg salary vs year cost by type, message=FALSE, warning=FALSE}
combine %>%
  filter(type_mod == "private for profit")%>%
  ggplot(aes(x=avg_year_cost, y=avg_earning)) +
    geom_point() +
    geom_smooth(method="lm") +
    labs(title="Avg Undergrade Salary vs. Avg year cost Private For Profit",
         x = "Avg Yearly School Cost",
         y = "Avg Undergrade Salary")

combine %>%
  filter(type_mod == "public")%>%
  ggplot(aes(x=avg_year_cost, y=avg_earning)) +
    geom_point() +
    geom_smooth(method="lm") +
    labs(title="Avg Undergrade Salary vs. Avg year cost vs Public",
         x = "Avg Yearly School Cost",
         y = "Avg Undergrade Salary")

```

Looking at these scatter plots we can see that they look fairly similar. Both seem to follow a strong linear trend of average undergrad salary increasing as average yearly cost increases. This suggests that the type of school might have no impact on our linear model. Lets check the private non profit schools just to make sure. 

Below is the scatter plot of Average undergrad salary vs average yearly cost for private non profit schools.
```{r message=FALSE, warning=FALSE}
combine %>%
  filter(type_mod == "private non profit")%>%
  ggplot(aes(x=avg_year_cost, y=avg_earning)) +
    geom_point() +
    geom_smooth(method="lm") +
    labs(title="Avg Undergrade Salary vs. Avg Yearly Cost Private Non Profit",
         x = "Avg Yearly School Cost",
         y = "Undergrade Salary")
```

Looking at this graph we can immediatly tell that it is very different from the other graphs. It does not seem to follow as strong of a linear trend as the other two schools and clearly the regression line is very different. This suggests that the type of school does factor into our prediction of average undergrad salary based off of average yearly school cost. 


Now we sill begin to create the linear models. We will create two linear models, one called model_school_type which tries to pridict the average undergrad salary based on the average yearly cost separated by school type. The second called model_earning will use only the average yearly cost to try and predict the average undergrad salary. 
```{r model of avg cost and avg Salary, message=FALSE, warning=FALSE}
model_school_type <- lm(formula = avg_earning ~ avg_year_cost*type_mod , data = combine)
model_earning <- lm(formula = avg_earning ~ avg_year_cost, data = combine)


tidy(model_school_type)
tidy(model_earning)
```

By looking at the results of these two models we can see that the p-value for each predictor is very close to 0. From this information we would reject the null hypothesis of no linear correlation for each model because the p-values are all below our rejection level of 0.05. This means that statistically speaking we cannot say that this data does not follow a linear regression. We need to perform more analysis in ordre to determine which model fits better.

Below we will plot the Residual created from each model vs the average yearly cost to determine how well each one fits the linear model. We will use a violin plot to determine the distributions.
```{r message=FALSE, warning=FALSE}
augment(model_earning) %>%
  ggplot(aes(x = cut(avg_year_cost, breaks=5), y = .resid)) +
  geom_violin() + 
  labs(title="Linear Regerssion: Residual vs Average Year Cost",
         x = "Average Year Cost",
         y = "Residual")

augment(model_school_type) %>%
  ggplot(aes(x = cut(avg_year_cost, breaks=5), y = .resid)) +
  geom_violin() + 
  labs(title="Linear Regerssion School Type: Residual vs Average Salary",
         x = "Average Year Cost",
         y = "Residual")
```

Just by glancing at these plots we can tell that they look almost identical. The distribution of residual spread across 5 categories of average yearly cost has a fairly normal distribution that is centered around 0 for each chunck of average yearly cost. This is exactly what we want to see from a plot of residual vs observation for a linear regression. This means that the residual is centered around zero but randomly distributed above and below indicating a linear fit. Lets use a scatter plot to further confirm our observation.

Here we will use a scatter plot to plot the residual vs. fitted value for each linear model and include a regression line to spot any trends.
```{r message=FALSE, warning=FALSE}
model_earning %>%
  broom::augment()%>%
   ggplot(aes(x=.fitted,y=.resid)) +
    geom_point() + 
    geom_smooth() +
    labs(title="Linear Regression: Residual vs. Fitted",
         x="fitted", y="residual")
```

This is a scatter plot of the linear model that only uses the average yearly cost as a predictor for average undergrad salary. From this plot we can see that for the most part the residual is centered around 0 but there is a lot of data scattered above the line compared to below it. We can also tell from looking at the regression line that there is a slight trend in the data with an uptick around \$35,000 and incrases as the fitted value increases. From this we can say that the relationship between avreage unergrad salary and average yearly cost is not entirely linear. Lets compare it to the graph of the other model.
```{r message=FALSE, warning=FALSE}
model_school_type %>%
  broom::augment()%>%
   ggplot(aes(x=.fitted,y=.resid)) +
    geom_point() + 
    geom_smooth() +
    labs(title="Linear Regression School Type: Residual vs. Fitted",
         x="fitted", y="residual")
```

From this scatter plot we can see a much better linear regression line that is nearly strait across the 0 axis for residual. There is a slight increase in the spread of residual as you approach \$60,000 for the fitted value but the rest of the graph seems to indicate that the relationship between average undergrad salary and average yearly cost based on school type is a stronger linear fit than our other model shown before.

From this linear analysis we can conclude that the average undergrad salary vs the average yearly cost of a university does follow a linear model. From visual analysis we can conclude that the model is improved if you include the type of university in the model. Aditional reading on linear regressions can be found [here](https://en.wikipedia.org/wiki/Linear_regression).


#Model Testing

In the section above we showed that the two linear models created testing the relationship between average undergrad salary vs average yearly cost both fit the model very well but concluded that the model that includes the school type might fit better. Lets perform an f-test to test this conclusion.

```{r message=FALSE, warning=FALSE}
f_test <- anova(model_earning, model_school_type, test="F")

f_test
```

From this f-test we can see that that model that includes school type is neglegably better than the other model. The model with school type has a residual of 20033 which is only slightly lower than the other model with a residual of 20037. In order to determine which model is better there needs to be a significant difference between these residuals but this test shows that ther is not. From this we can conclude that both models have a fairly similar fit.

#Conclusion
Throughout this tutorial we have shown how to combine multiple datasets into one tidy dataset used for analysis. We have also shown how to analyze the data to look for correlations within the datasets. After finding apparent correlations we showed how to fit the data to a linear model using multiple predictors and then how to analyze and compare different models to determine best fit and linearity. 


```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}

avg_nums_2012 <- combine %>%
  filter( year %in% "2012") %>%
  drop_na(avg_earning, avg_fac_sal_year) %>%
  select(id, avg_fac_sal_year, avg_earning) %>%
  arrange(id)

final_df <- combine %>%
  filter( year %in% "2013") %>%
  drop_na(avg_earning, avg_fac_sal_year) %>%
  select(id, avg_fac_sal_year, avg_earning) %>%
  inner_join(avg_nums_2012, by="id") %>%
  mutate(fac_sal_diff = avg_fac_sal_year.x - avg_fac_sal_year.y, avg_earning_diff = avg_earning.x - avg_earning.y) %>%
  mutate(earning_direction = ifelse(avg_earning_diff>0, "up", "down")) %>%
  select(id, fac_sal_diff, earning_direction) %>%
  mutate(earning_direction=factor(earning_direction, levels=c("down", "up")))
final_df
  
```